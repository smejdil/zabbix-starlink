{
    "zabbix_export": {
        "version": "6.4",
        "template_groups": [
            {
                "uuid": "75462cf1d1644578998103ea76f45b16",
                "name": "Templates/Open-Tech"
            }
        ],
        "templates": [
            {
                "uuid": "34fe31ea9f4a4c4c9108a25bab9a6496",
                "template": "Starlink dish by Prom",
                "name": "Starlink dish by Prom",
                "description": "Use project Python starlink-grpc-tools\n\nhttps://github.com/sparky8512/starlink-grpc-tools\n\nRun Starlink exporter:\npython dish_grpc_prometheus.py status",
                "groups": [
                    {
                        "name": "Templates/Open-Tech"
                    }
                ],
                "items": [
                    {
                        "uuid": "f92e9d4a724d4d3db3f886e159829985",
                        "name": "Starlink alerts",
                        "type": "DEPENDENT",
                        "key": "starlink.alerts",
                        "delay": "0",
                        "value_type": "FLOAT",
                        "preprocessing": [
                            {
                                "type": "PROMETHEUS_PATTERN",
                                "parameters": [
                                    "{__name__=~\"^starlink_status_alerts\"}",
                                    "value",
                                    ""
                                ]
                            }
                        ],
                        "master_item": {
                            "key": "zbx.starlink.dish.data"
                        },
                        "tags": [
                            {
                                "tag": "component",
                                "value": "starlink"
                            },
                            {
                                "tag": "scope",
                                "value": "alert"
                            }
                        ],
                        "triggers": [
                            {
                                "uuid": "e037f5104eab42b4bc295745564b4125",
                                "expression": "last(/Starlink dish by Prom/starlink.alerts,#3)=128",
                                "name": "Starlink alert install pending",
                                "opdata": "Current value: {ITEM.LASTVALUE1}",
                                "priority": "INFO",
                                "description": "Starlink alert install pending. Ack to close",
                                "manual_close": "YES",
                                "tags": [
                                    {
                                        "tag": "scope",
                                        "value": "notice"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "uuid": "b0dac1b1955d4b5ebd8796e0539ce645",
                        "name": "Starlink currently obstructed",
                        "type": "DEPENDENT",
                        "key": "starlink.currently_obstructed",
                        "delay": "0",
                        "value_type": "FLOAT",
                        "preprocessing": [
                            {
                                "type": "PROMETHEUS_PATTERN",
                                "parameters": [
                                    "{__name__=~\"^starlink_status_currently_obstructed\"}",
                                    "value",
                                    ""
                                ]
                            }
                        ],
                        "master_item": {
                            "key": "zbx.starlink.dish.data"
                        },
                        "tags": [
                            {
                                "tag": "component",
                                "value": "starlink"
                            },
                            {
                                "tag": "scope",
                                "value": "obstructed"
                            }
                        ]
                    },
                    {
                        "uuid": "304b25f054c34d3dbededb09681b3e3b",
                        "name": "Starlink direction azimuth",
                        "type": "DEPENDENT",
                        "key": "starlink.direction_azimuth",
                        "delay": "0",
                        "value_type": "FLOAT",
                        "preprocessing": [
                            {
                                "type": "PROMETHEUS_PATTERN",
                                "parameters": [
                                    "{__name__=~\"^starlink_status_direction_azimuth\"}",
                                    "value",
                                    ""
                                ]
                            }
                        ],
                        "master_item": {
                            "key": "zbx.starlink.dish.data"
                        },
                        "tags": [
                            {
                                "tag": "component",
                                "value": "starlink"
                            }
                        ]
                    },
                    {
                        "uuid": "eb1954e0502f4647b8f9a6b7c7c94fcf",
                        "name": "Starlink direction elevation",
                        "type": "DEPENDENT",
                        "key": "starlink.direction_elevation",
                        "delay": "0",
                        "value_type": "FLOAT",
                        "preprocessing": [
                            {
                                "type": "PROMETHEUS_PATTERN",
                                "parameters": [
                                    "{__name__=~\"^starlink_status_direction_elevation\"}",
                                    "value",
                                    ""
                                ]
                            }
                        ],
                        "master_item": {
                            "key": "zbx.starlink.dish.data"
                        },
                        "tags": [
                            {
                                "tag": "component",
                                "value": "starlink"
                            }
                        ]
                    },
                    {
                        "uuid": "6cd97913ed1e458db24dc9f396f7149b",
                        "name": "Starlink downlink throughput bps",
                        "type": "DEPENDENT",
                        "key": "starlink.downlink",
                        "delay": "0",
                        "value_type": "FLOAT",
                        "units": "bps",
                        "preprocessing": [
                            {
                                "type": "PROMETHEUS_PATTERN",
                                "parameters": [
                                    "{__name__=~\"^starlink_status_downlink_throughput_bps\"}",
                                    "value",
                                    ""
                                ]
                            }
                        ],
                        "master_item": {
                            "key": "zbx.starlink.dish.data"
                        },
                        "tags": [
                            {
                                "tag": "component",
                                "value": "starlink"
                            },
                            {
                                "tag": "scope",
                                "value": "traffic"
                            }
                        ]
                    },
                    {
                        "uuid": "94a989ad80bb403b9459a20552b8f4d2",
                        "name": "Starlink fraction obstructed",
                        "type": "DEPENDENT",
                        "key": "starlink.fraction_obstructed",
                        "delay": "0",
                        "value_type": "FLOAT",
                        "preprocessing": [
                            {
                                "type": "PROMETHEUS_PATTERN",
                                "parameters": [
                                    "{__name__=~\"^starlink_status_fraction_obstructed\"}",
                                    "value",
                                    ""
                                ]
                            }
                        ],
                        "master_item": {
                            "key": "zbx.starlink.dish.data"
                        },
                        "tags": [
                            {
                                "tag": "component",
                                "value": "starlink"
                            },
                            {
                                "tag": "scope",
                                "value": "obstructed"
                            }
                        ]
                    },
                    {
                        "uuid": "af1d33184f924b2f903507602ee2e779",
                        "name": "Starlink hardware version",
                        "type": "DEPENDENT",
                        "key": "starlink.hardware_version",
                        "delay": "0",
                        "trends": "0",
                        "value_type": "CHAR",
                        "preprocessing": [
                            {
                                "type": "PROMETHEUS_PATTERN",
                                "parameters": [
                                    "starlink_info",
                                    "label",
                                    "hardware_version"
                                ]
                            }
                        ],
                        "master_item": {
                            "key": "zbx.starlink.dish.data"
                        },
                        "tags": [
                            {
                                "tag": "component",
                                "value": "starlink"
                            }
                        ]
                    },
                    {
                        "uuid": "8bd3039a86344dadb31f4c7d91897f6c",
                        "name": "Starlink ID",
                        "type": "DEPENDENT",
                        "key": "starlink.id",
                        "delay": "0",
                        "trends": "0",
                        "value_type": "CHAR",
                        "preprocessing": [
                            {
                                "type": "PROMETHEUS_PATTERN",
                                "parameters": [
                                    "starlink_info",
                                    "label",
                                    "id"
                                ]
                            }
                        ],
                        "master_item": {
                            "key": "zbx.starlink.dish.data"
                        },
                        "tags": [
                            {
                                "tag": "component",
                                "value": "starlink"
                            }
                        ]
                    },
                    {
                        "uuid": "2dc68f7b12394d30972ee5289e3f995d",
                        "name": "Starlink obstruction duration",
                        "type": "DEPENDENT",
                        "key": "starlink.obstruction_duration",
                        "delay": "0",
                        "value_type": "FLOAT",
                        "preprocessing": [
                            {
                                "type": "PROMETHEUS_PATTERN",
                                "parameters": [
                                    "{__name__=~\"^starlink_status_obstruction_duration\"}",
                                    "value",
                                    ""
                                ]
                            }
                        ],
                        "master_item": {
                            "key": "zbx.starlink.dish.data"
                        },
                        "tags": [
                            {
                                "tag": "component",
                                "value": "starlink"
                            }
                        ]
                    },
                    {
                        "uuid": "151c8ac1204b484b827bb9e802cd0c12",
                        "name": "Starlink obstruction interval",
                        "type": "DEPENDENT",
                        "key": "starlink.obstruction_interval",
                        "delay": "0",
                        "value_type": "FLOAT",
                        "preprocessing": [
                            {
                                "type": "PROMETHEUS_PATTERN",
                                "parameters": [
                                    "{__name__=~\"^starlink_status_obstruction_interval\"}",
                                    "value",
                                    ""
                                ]
                            }
                        ],
                        "master_item": {
                            "key": "zbx.starlink.dish.data"
                        },
                        "tags": [
                            {
                                "tag": "component",
                                "value": "starlink"
                            }
                        ]
                    },
                    {
                        "uuid": "044d5748016d40d7bd6b567e0d40f191",
                        "name": "Starlink ping latency",
                        "type": "DEPENDENT",
                        "key": "starlink.ping.latency",
                        "delay": "0",
                        "value_type": "FLOAT",
                        "preprocessing": [
                            {
                                "type": "PROMETHEUS_PATTERN",
                                "parameters": [
                                    "{__name__=~\"^starlink_status_pop_ping_latency_ms(?:_seconds)?$\"}",
                                    "value",
                                    ""
                                ]
                            }
                        ],
                        "master_item": {
                            "key": "zbx.starlink.dish.data"
                        },
                        "tags": [
                            {
                                "tag": "component",
                                "value": "starlink"
                            },
                            {
                                "tag": "scope",
                                "value": "ping"
                            }
                        ]
                    },
                    {
                        "uuid": "3931699111354670bf98ba905b22ba07",
                        "name": "Starlink pop ping drop rate",
                        "type": "DEPENDENT",
                        "key": "starlink.pop.ping.drop_rate",
                        "delay": "0",
                        "value_type": "FLOAT",
                        "preprocessing": [
                            {
                                "type": "PROMETHEUS_PATTERN",
                                "parameters": [
                                    "{__name__=~\"^starlink_status_pop_ping_drop_rate(?:_seconds)?$\"}",
                                    "value",
                                    ""
                                ]
                            }
                        ],
                        "master_item": {
                            "key": "zbx.starlink.dish.data"
                        },
                        "tags": [
                            {
                                "tag": "component",
                                "value": "starlink"
                            },
                            {
                                "tag": "scope",
                                "value": "ping"
                            }
                        ]
                    },
                    {
                        "uuid": "038a0047c8ff42d893ee819688387cf6",
                        "name": "Starlink seconds to first nonempty slot",
                        "type": "DEPENDENT",
                        "key": "starlink.seconds.to.first.nonempty_slot",
                        "delay": "0",
                        "value_type": "FLOAT",
                        "preprocessing": [
                            {
                                "type": "PROMETHEUS_PATTERN",
                                "parameters": [
                                    "{__name__=~\"^starlink_status_seconds_to_first_nonempty_slot\"}",
                                    "value",
                                    ""
                                ]
                            }
                        ],
                        "master_item": {
                            "key": "zbx.starlink.dish.data"
                        },
                        "tags": [
                            {
                                "tag": "component",
                                "value": "starlink"
                            }
                        ]
                    },
                    {
                        "uuid": "605d50f7dd724ad9911d065c525fb684",
                        "name": "Starlink seconds obstructed",
                        "type": "DEPENDENT",
                        "key": "starlink.seconds_obstructed",
                        "delay": "0",
                        "value_type": "FLOAT",
                        "preprocessing": [
                            {
                                "type": "PROMETHEUS_PATTERN",
                                "parameters": [
                                    "{__name__=~\"^starlink_status_seconds_obstructed\"}",
                                    "value",
                                    ""
                                ]
                            }
                        ],
                        "master_item": {
                            "key": "zbx.starlink.dish.data"
                        },
                        "tags": [
                            {
                                "tag": "component",
                                "value": "starlink"
                            },
                            {
                                "tag": "scope",
                                "value": "obstructed"
                            }
                        ]
                    },
                    {
                        "uuid": "60aab4d771794465a0074d7e7b5df9fa",
                        "name": "Starlink snr above noise floor",
                        "type": "DEPENDENT",
                        "key": "starlink.snr_above_noise_floor",
                        "delay": "0",
                        "value_type": "FLOAT",
                        "preprocessing": [
                            {
                                "type": "PROMETHEUS_PATTERN",
                                "parameters": [
                                    "{__name__=~\"^starlink_status_is_snr_above_noise_floor\"}",
                                    "value",
                                    ""
                                ]
                            }
                        ],
                        "master_item": {
                            "key": "zbx.starlink.dish.data"
                        },
                        "tags": [
                            {
                                "tag": "component",
                                "value": "starlink"
                            }
                        ]
                    },
                    {
                        "uuid": "250ab23f912a4aeeaca573b23e7f4025",
                        "name": "Starlink software version",
                        "type": "DEPENDENT",
                        "key": "starlink.software_version",
                        "delay": "0",
                        "trends": "0",
                        "value_type": "CHAR",
                        "preprocessing": [
                            {
                                "type": "PROMETHEUS_PATTERN",
                                "parameters": [
                                    "starlink_info",
                                    "label",
                                    "software_version"
                                ]
                            }
                        ],
                        "master_item": {
                            "key": "zbx.starlink.dish.data"
                        },
                        "tags": [
                            {
                                "tag": "component",
                                "value": "starlink"
                            }
                        ],
                        "triggers": [
                            {
                                "uuid": "f3f72018b726451a92e3c0b7a5742e61",
                                "expression": "last(/Starlink dish by Prom/starlink.software_version,#1)<>last(/Starlink dish by Prom/starlink.software_version,#2) and length(last(/Starlink dish by Prom/starlink.software_version))>0",
                                "name": "Starlink firmware has changed",
                                "opdata": "Current value: {ITEM.LASTVALUE1}",
                                "priority": "INFO",
                                "description": "Firmware version has changed. Ack to close",
                                "manual_close": "YES",
                                "tags": [
                                    {
                                        "tag": "scope",
                                        "value": "firmware"
                                    },
                                    {
                                        "tag": "scope",
                                        "value": "notice"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "uuid": "8c02f45b1dea41e7b8c488c3f137aaa3",
                        "name": "Starlink state",
                        "type": "DEPENDENT",
                        "key": "starlink.state",
                        "delay": "0",
                        "trends": "0",
                        "value_type": "CHAR",
                        "preprocessing": [
                            {
                                "type": "PROMETHEUS_PATTERN",
                                "parameters": [
                                    "starlink_status_state{state=~\".*\"}==1",
                                    "label",
                                    "state"
                                ]
                            }
                        ],
                        "master_item": {
                            "key": "zbx.starlink.dish.data"
                        },
                        "tags": [
                            {
                                "tag": "component",
                                "value": "starlink"
                            }
                        ],
                        "triggers": [
                            {
                                "uuid": "18cde597443e408c9c0f0a872e20f030",
                                "expression": "last(/Starlink dish by Prom/starlink.state,#1)<>last(/Starlink dish by Prom/starlink.state,#2) and length(last(/Starlink dish by Prom/starlink.state))>0",
                                "name": "Starlink status has changed",
                                "opdata": "Current value: {ITEM.LASTVALUE1}",
                                "priority": "AVERAGE",
                                "description": "Status has changed. Ack to close",
                                "manual_close": "YES",
                                "tags": [
                                    {
                                        "tag": "scope",
                                        "value": "status"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "uuid": "433d7c0358444aef8b8389eeaa670cdb",
                        "name": "Starlink uplink throughput bps",
                        "type": "DEPENDENT",
                        "key": "starlink.uplink",
                        "delay": "0",
                        "value_type": "FLOAT",
                        "units": "bps",
                        "preprocessing": [
                            {
                                "type": "PROMETHEUS_PATTERN",
                                "parameters": [
                                    "{__name__=~\"^starlink_status_uplink_throughput_bps\"}",
                                    "value",
                                    ""
                                ]
                            }
                        ],
                        "master_item": {
                            "key": "zbx.starlink.dish.data"
                        },
                        "tags": [
                            {
                                "tag": "component",
                                "value": "starlink"
                            },
                            {
                                "tag": "scope",
                                "value": "traffic"
                            }
                        ]
                    },
                    {
                        "uuid": "e2adf9f168cf4780ba874b98cc248718",
                        "name": "Starlink uptime",
                        "type": "DEPENDENT",
                        "key": "starlink.uptime",
                        "delay": "0",
                        "value_type": "FLOAT",
                        "units": "uptime",
                        "description": "Starlink uptime in 'N days, hh:mm:ss' format.",
                        "preprocessing": [
                            {
                                "type": "PROMETHEUS_PATTERN",
                                "parameters": [
                                    "{__name__=~\"^starlink_status_uptime_seconds(?:_seconds)?$\"}",
                                    "value",
                                    ""
                                ]
                            }
                        ],
                        "master_item": {
                            "key": "zbx.starlink.dish.data"
                        },
                        "tags": [
                            {
                                "tag": "component",
                                "value": "starlink"
                            }
                        ],
                        "triggers": [
                            {
                                "uuid": "cb30b86dc73e46979425c99b5475e281",
                                "expression": "last(/Starlink dish by Prom/starlink.uptime)<10m",
                                "name": "{HOST.NAME} has been restarted (uptime < 10m)",
                                "priority": "WARNING",
                                "description": "Uptime is less than 10 minutes",
                                "manual_close": "YES",
                                "tags": [
                                    {
                                        "tag": "scope",
                                        "value": "notice"
                                    }
                                ]
                            }
                        ]
                    },
                    {
                        "uuid": "e999c02c61d3489194b011fdb9af9cb3",
                        "name": "Starlink: Get dish data",
                        "type": "HTTP_AGENT",
                        "key": "zbx.starlink.dish.data",
                        "history": "0",
                        "trends": "0",
                        "value_type": "TEXT",
                        "url": "{$STARLINK.SCHEME}://{HOST.CONN}:{$STARLINK.PORT}/metrics",
                        "tags": [
                            {
                                "tag": "component",
                                "value": "raw"
                            }
                        ],
                        "triggers": [
                            {
                                "uuid": "e9257e8f2bc64765a2cfcee60b298695",
                                "expression": "nodata(/Starlink dish by Prom/zbx.starlink.dish.data,30)=1",
                                "name": "starlink_exporter is not available (or no data for 30m)",
                                "priority": "WARNING",
                                "description": "Failed to fetch starlink metrics from starlink_exporter in time.",
                                "manual_close": "YES",
                                "tags": [
                                    {
                                        "tag": "scope",
                                        "value": "availability"
                                    }
                                ]
                            }
                        ]
                    }
                ],
                "tags": [
                    {
                        "tag": "class",
                        "value": "hardware"
                    },
                    {
                        "tag": "target",
                        "value": "starlink"
                    }
                ],
                "macros": [
                    {
                        "macro": "{$STARLINK.PORT}",
                        "value": "8080"
                    },
                    {
                        "macro": "{$STARLINK.SCHEME}",
                        "value": "http"
                    }
                ],
                "dashboards": [
                    {
                        "uuid": "e820ec353f0741a0b379e6e1d6916f09",
                        "name": "Starlink traffic",
                        "pages": [
                            {
                                "widgets": [
                                    {
                                        "type": "graph",
                                        "width": "24",
                                        "height": "7",
                                        "fields": [
                                            {
                                                "type": "GRAPH",
                                                "name": "graphid",
                                                "value": {
                                                    "host": "Starlink dish by Prom",
                                                    "name": "Starlink traffic"
                                                }
                                            }
                                        ]
                                    }
                                ]
                            }
                        ]
                    }
                ]
            }
        ],
        "graphs": [
            {
                "uuid": "9b23b40ec0cc4632afc10e70a3e70cfe",
                "name": "Starlink traffic",
                "graph_items": [
                    {
                        "drawtype": "FILLED_REGION",
                        "color": "199C0D",
                        "calc_fnc": "ALL",
                        "item": {
                            "host": "Starlink dish by Prom",
                            "key": "starlink.downlink"
                        }
                    },
                    {
                        "sortorder": "1",
                        "drawtype": "FILLED_REGION",
                        "color": "0040FF",
                        "calc_fnc": "ALL",
                        "item": {
                            "host": "Starlink dish by Prom",
                            "key": "starlink.uplink"
                        }
                    }
                ]
            }
        ]
    }
}