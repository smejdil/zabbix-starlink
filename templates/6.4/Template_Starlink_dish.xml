<?xml version="1.0" encoding="UTF-8"?>
<zabbix_export>
    <version>6.4</version>
    <template_groups>
        <template_group>
            <uuid>75462cf1d1644578998103ea76f45b16</uuid>
            <name>Templates/Open-Tech</name>
        </template_group>
    </template_groups>
    <templates>
        <template>
            <uuid>34fe31ea9f4a4c4c9108a25bab9a6496</uuid>
            <template>Starlink dish by Prom</template>
            <name>Starlink dish by Prom</name>
            <description>Use project Python starlink-grpc-tools

https://github.com/sparky8512/starlink-grpc-tools

Run Starlink exporter:
python dish_grpc_prometheus.py status</description>
            <groups>
                <group>
                    <name>Templates/Open-Tech</name>
                </group>
            </groups>
            <items>
                <item>
                    <uuid>f92e9d4a724d4d3db3f886e159829985</uuid>
                    <name>Starlink alerts</name>
                    <type>DEPENDENT</type>
                    <key>starlink.alerts</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <preprocessing>
                        <step>
                            <type>PROMETHEUS_PATTERN</type>
                            <parameters>
                                <parameter>{__name__=~&quot;^starlink_status_alerts&quot;}</parameter>
                                <parameter>value</parameter>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>zbx.starlink.dish.data</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>starlink</value>
                        </tag>
                        <tag>
                            <tag>scope</tag>
                            <value>alert</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>e037f5104eab42b4bc295745564b4125</uuid>
                            <expression>last(/Starlink dish by Prom/starlink.alerts,#3)=128</expression>
                            <name>Starlink alert install pending</name>
                            <opdata>Current value: {ITEM.LASTVALUE1}</opdata>
                            <priority>INFO</priority>
                            <description>Starlink alert install pending. Ack to close</description>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>notice</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>b0dac1b1955d4b5ebd8796e0539ce645</uuid>
                    <name>Starlink currently obstructed</name>
                    <type>DEPENDENT</type>
                    <key>starlink.currently_obstructed</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <preprocessing>
                        <step>
                            <type>PROMETHEUS_PATTERN</type>
                            <parameters>
                                <parameter>{__name__=~&quot;^starlink_status_currently_obstructed&quot;}</parameter>
                                <parameter>value</parameter>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>zbx.starlink.dish.data</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>starlink</value>
                        </tag>
                        <tag>
                            <tag>scope</tag>
                            <value>obstructed</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>304b25f054c34d3dbededb09681b3e3b</uuid>
                    <name>Starlink direction azimuth</name>
                    <type>DEPENDENT</type>
                    <key>starlink.direction_azimuth</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <preprocessing>
                        <step>
                            <type>PROMETHEUS_PATTERN</type>
                            <parameters>
                                <parameter>{__name__=~&quot;^starlink_status_direction_azimuth&quot;}</parameter>
                                <parameter>value</parameter>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>zbx.starlink.dish.data</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>starlink</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>eb1954e0502f4647b8f9a6b7c7c94fcf</uuid>
                    <name>Starlink direction elevation</name>
                    <type>DEPENDENT</type>
                    <key>starlink.direction_elevation</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <preprocessing>
                        <step>
                            <type>PROMETHEUS_PATTERN</type>
                            <parameters>
                                <parameter>{__name__=~&quot;^starlink_status_direction_elevation&quot;}</parameter>
                                <parameter>value</parameter>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>zbx.starlink.dish.data</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>starlink</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>6cd97913ed1e458db24dc9f396f7149b</uuid>
                    <name>Starlink downlink throughput bps</name>
                    <type>DEPENDENT</type>
                    <key>starlink.downlink</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <units>bps</units>
                    <preprocessing>
                        <step>
                            <type>PROMETHEUS_PATTERN</type>
                            <parameters>
                                <parameter>{__name__=~&quot;^starlink_status_downlink_throughput_bps&quot;}</parameter>
                                <parameter>value</parameter>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>zbx.starlink.dish.data</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>starlink</value>
                        </tag>
                        <tag>
                            <tag>scope</tag>
                            <value>traffic</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>94a989ad80bb403b9459a20552b8f4d2</uuid>
                    <name>Starlink fraction obstructed</name>
                    <type>DEPENDENT</type>
                    <key>starlink.fraction_obstructed</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <preprocessing>
                        <step>
                            <type>PROMETHEUS_PATTERN</type>
                            <parameters>
                                <parameter>{__name__=~&quot;^starlink_status_fraction_obstructed&quot;}</parameter>
                                <parameter>value</parameter>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>zbx.starlink.dish.data</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>starlink</value>
                        </tag>
                        <tag>
                            <tag>scope</tag>
                            <value>obstructed</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>af1d33184f924b2f903507602ee2e779</uuid>
                    <name>Starlink hardware version</name>
                    <type>DEPENDENT</type>
                    <key>starlink.hardware_version</key>
                    <delay>0</delay>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <preprocessing>
                        <step>
                            <type>PROMETHEUS_PATTERN</type>
                            <parameters>
                                <parameter>starlink_info</parameter>
                                <parameter>label</parameter>
                                <parameter>hardware_version</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>zbx.starlink.dish.data</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>starlink</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>8bd3039a86344dadb31f4c7d91897f6c</uuid>
                    <name>Starlink ID</name>
                    <type>DEPENDENT</type>
                    <key>starlink.id</key>
                    <delay>0</delay>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <preprocessing>
                        <step>
                            <type>PROMETHEUS_PATTERN</type>
                            <parameters>
                                <parameter>starlink_info</parameter>
                                <parameter>label</parameter>
                                <parameter>id</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>zbx.starlink.dish.data</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>starlink</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>2dc68f7b12394d30972ee5289e3f995d</uuid>
                    <name>Starlink obstruction duration</name>
                    <type>DEPENDENT</type>
                    <key>starlink.obstruction_duration</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <preprocessing>
                        <step>
                            <type>PROMETHEUS_PATTERN</type>
                            <parameters>
                                <parameter>{__name__=~&quot;^starlink_status_obstruction_duration&quot;}</parameter>
                                <parameter>value</parameter>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>zbx.starlink.dish.data</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>starlink</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>151c8ac1204b484b827bb9e802cd0c12</uuid>
                    <name>Starlink obstruction interval</name>
                    <type>DEPENDENT</type>
                    <key>starlink.obstruction_interval</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <preprocessing>
                        <step>
                            <type>PROMETHEUS_PATTERN</type>
                            <parameters>
                                <parameter>{__name__=~&quot;^starlink_status_obstruction_interval&quot;}</parameter>
                                <parameter>value</parameter>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>zbx.starlink.dish.data</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>starlink</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>044d5748016d40d7bd6b567e0d40f191</uuid>
                    <name>Starlink ping latency</name>
                    <type>DEPENDENT</type>
                    <key>starlink.ping.latency</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <preprocessing>
                        <step>
                            <type>PROMETHEUS_PATTERN</type>
                            <parameters>
                                <parameter>{__name__=~&quot;^starlink_status_pop_ping_latency_ms(?:_seconds)?$&quot;}</parameter>
                                <parameter>value</parameter>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>zbx.starlink.dish.data</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>starlink</value>
                        </tag>
                        <tag>
                            <tag>scope</tag>
                            <value>ping</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>3931699111354670bf98ba905b22ba07</uuid>
                    <name>Starlink pop ping drop rate</name>
                    <type>DEPENDENT</type>
                    <key>starlink.pop.ping.drop_rate</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <preprocessing>
                        <step>
                            <type>PROMETHEUS_PATTERN</type>
                            <parameters>
                                <parameter>{__name__=~&quot;^starlink_status_pop_ping_drop_rate(?:_seconds)?$&quot;}</parameter>
                                <parameter>value</parameter>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>zbx.starlink.dish.data</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>starlink</value>
                        </tag>
                        <tag>
                            <tag>scope</tag>
                            <value>ping</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>038a0047c8ff42d893ee819688387cf6</uuid>
                    <name>Starlink seconds to first nonempty slot</name>
                    <type>DEPENDENT</type>
                    <key>starlink.seconds.to.first.nonempty_slot</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <preprocessing>
                        <step>
                            <type>PROMETHEUS_PATTERN</type>
                            <parameters>
                                <parameter>{__name__=~&quot;^starlink_status_seconds_to_first_nonempty_slot&quot;}</parameter>
                                <parameter>value</parameter>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>zbx.starlink.dish.data</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>starlink</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>605d50f7dd724ad9911d065c525fb684</uuid>
                    <name>Starlink seconds obstructed</name>
                    <type>DEPENDENT</type>
                    <key>starlink.seconds_obstructed</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <preprocessing>
                        <step>
                            <type>PROMETHEUS_PATTERN</type>
                            <parameters>
                                <parameter>{__name__=~&quot;^starlink_status_seconds_obstructed&quot;}</parameter>
                                <parameter>value</parameter>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>zbx.starlink.dish.data</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>starlink</value>
                        </tag>
                        <tag>
                            <tag>scope</tag>
                            <value>obstructed</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>60aab4d771794465a0074d7e7b5df9fa</uuid>
                    <name>Starlink snr above noise floor</name>
                    <type>DEPENDENT</type>
                    <key>starlink.snr_above_noise_floor</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <preprocessing>
                        <step>
                            <type>PROMETHEUS_PATTERN</type>
                            <parameters>
                                <parameter>{__name__=~&quot;^starlink_status_is_snr_above_noise_floor&quot;}</parameter>
                                <parameter>value</parameter>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>zbx.starlink.dish.data</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>starlink</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>250ab23f912a4aeeaca573b23e7f4025</uuid>
                    <name>Starlink software version</name>
                    <type>DEPENDENT</type>
                    <key>starlink.software_version</key>
                    <delay>0</delay>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <preprocessing>
                        <step>
                            <type>PROMETHEUS_PATTERN</type>
                            <parameters>
                                <parameter>starlink_info</parameter>
                                <parameter>label</parameter>
                                <parameter>software_version</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>zbx.starlink.dish.data</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>starlink</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>f3f72018b726451a92e3c0b7a5742e61</uuid>
                            <expression>last(/Starlink dish by Prom/starlink.software_version,#1)&lt;&gt;last(/Starlink dish by Prom/starlink.software_version,#2) and length(last(/Starlink dish by Prom/starlink.software_version))&gt;0</expression>
                            <name>Starlink firmware has changed</name>
                            <opdata>Current value: {ITEM.LASTVALUE1}</opdata>
                            <priority>INFO</priority>
                            <description>Firmware version has changed. Ack to close</description>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>firmware</value>
                                </tag>
                                <tag>
                                    <tag>scope</tag>
                                    <value>notice</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>8c02f45b1dea41e7b8c488c3f137aaa3</uuid>
                    <name>Starlink state</name>
                    <type>DEPENDENT</type>
                    <key>starlink.state</key>
                    <delay>0</delay>
                    <trends>0</trends>
                    <value_type>CHAR</value_type>
                    <preprocessing>
                        <step>
                            <type>PROMETHEUS_PATTERN</type>
                            <parameters>
                                <parameter>starlink_status_state{state=~&quot;.*&quot;}==1</parameter>
                                <parameter>label</parameter>
                                <parameter>state</parameter>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>zbx.starlink.dish.data</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>starlink</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>18cde597443e408c9c0f0a872e20f030</uuid>
                            <expression>last(/Starlink dish by Prom/starlink.state,#1)&lt;&gt;last(/Starlink dish by Prom/starlink.state,#2) and length(last(/Starlink dish by Prom/starlink.state))&gt;0</expression>
                            <name>Starlink status has changed</name>
                            <opdata>Current value: {ITEM.LASTVALUE1}</opdata>
                            <priority>AVERAGE</priority>
                            <description>Status has changed. Ack to close</description>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>status</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>433d7c0358444aef8b8389eeaa670cdb</uuid>
                    <name>Starlink uplink throughput bps</name>
                    <type>DEPENDENT</type>
                    <key>starlink.uplink</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <units>bps</units>
                    <preprocessing>
                        <step>
                            <type>PROMETHEUS_PATTERN</type>
                            <parameters>
                                <parameter>{__name__=~&quot;^starlink_status_uplink_throughput_bps&quot;}</parameter>
                                <parameter>value</parameter>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>zbx.starlink.dish.data</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>starlink</value>
                        </tag>
                        <tag>
                            <tag>scope</tag>
                            <value>traffic</value>
                        </tag>
                    </tags>
                </item>
                <item>
                    <uuid>e2adf9f168cf4780ba874b98cc248718</uuid>
                    <name>Starlink uptime</name>
                    <type>DEPENDENT</type>
                    <key>starlink.uptime</key>
                    <delay>0</delay>
                    <value_type>FLOAT</value_type>
                    <units>uptime</units>
                    <description>Starlink uptime in 'N days, hh:mm:ss' format.</description>
                    <preprocessing>
                        <step>
                            <type>PROMETHEUS_PATTERN</type>
                            <parameters>
                                <parameter>{__name__=~&quot;^starlink_status_uptime_seconds(?:_seconds)?$&quot;}</parameter>
                                <parameter>value</parameter>
                                <parameter/>
                            </parameters>
                        </step>
                    </preprocessing>
                    <master_item>
                        <key>zbx.starlink.dish.data</key>
                    </master_item>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>starlink</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>cb30b86dc73e46979425c99b5475e281</uuid>
                            <expression>last(/Starlink dish by Prom/starlink.uptime)&lt;10m</expression>
                            <name>{HOST.NAME} has been restarted (uptime &lt; 10m)</name>
                            <priority>WARNING</priority>
                            <description>Uptime is less than 10 minutes</description>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>notice</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
                <item>
                    <uuid>e999c02c61d3489194b011fdb9af9cb3</uuid>
                    <name>Starlink: Get dish data</name>
                    <type>HTTP_AGENT</type>
                    <key>zbx.starlink.dish.data</key>
                    <history>0</history>
                    <trends>0</trends>
                    <value_type>TEXT</value_type>
                    <url>{$STARLINK.SCHEME}://{HOST.CONN}:{$STARLINK.PORT}/metrics</url>
                    <tags>
                        <tag>
                            <tag>component</tag>
                            <value>raw</value>
                        </tag>
                    </tags>
                    <triggers>
                        <trigger>
                            <uuid>e9257e8f2bc64765a2cfcee60b298695</uuid>
                            <expression>nodata(/Starlink dish by Prom/zbx.starlink.dish.data,30)=1</expression>
                            <name>starlink_exporter is not available (or no data for 30m)</name>
                            <priority>WARNING</priority>
                            <description>Failed to fetch starlink metrics from starlink_exporter in time.</description>
                            <manual_close>YES</manual_close>
                            <tags>
                                <tag>
                                    <tag>scope</tag>
                                    <value>availability</value>
                                </tag>
                            </tags>
                        </trigger>
                    </triggers>
                </item>
            </items>
            <tags>
                <tag>
                    <tag>class</tag>
                    <value>hardware</value>
                </tag>
                <tag>
                    <tag>target</tag>
                    <value>starlink</value>
                </tag>
            </tags>
            <macros>
                <macro>
                    <macro>{$STARLINK.PORT}</macro>
                    <value>8080</value>
                </macro>
                <macro>
                    <macro>{$STARLINK.SCHEME}</macro>
                    <value>http</value>
                </macro>
            </macros>
            <dashboards>
                <dashboard>
                    <uuid>e820ec353f0741a0b379e6e1d6916f09</uuid>
                    <name>Starlink traffic</name>
                    <pages>
                        <page>
                            <widgets>
                                <widget>
                                    <type>graph</type>
                                    <width>24</width>
                                    <height>7</height>
                                    <fields>
                                        <field>
                                            <type>GRAPH</type>
                                            <name>graphid</name>
                                            <value>
                                                <host>Starlink dish by Prom</host>
                                                <name>Starlink traffic</name>
                                            </value>
                                        </field>
                                    </fields>
                                </widget>
                            </widgets>
                        </page>
                    </pages>
                </dashboard>
            </dashboards>
        </template>
    </templates>
    <graphs>
        <graph>
            <uuid>9b23b40ec0cc4632afc10e70a3e70cfe</uuid>
            <name>Starlink traffic</name>
            <graph_items>
                <graph_item>
                    <drawtype>FILLED_REGION</drawtype>
                    <color>199C0D</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Starlink dish by Prom</host>
                        <key>starlink.downlink</key>
                    </item>
                </graph_item>
                <graph_item>
                    <sortorder>1</sortorder>
                    <drawtype>FILLED_REGION</drawtype>
                    <color>0040FF</color>
                    <calc_fnc>ALL</calc_fnc>
                    <item>
                        <host>Starlink dish by Prom</host>
                        <key>starlink.uplink</key>
                    </item>
                </graph_item>
            </graph_items>
        </graph>
    </graphs>
</zabbix_export>
